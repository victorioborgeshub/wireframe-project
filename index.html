<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Performance Wireframe</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./wireframe.css" />
  </head>
  <body>
    <main class="page" aria-label="AI Performance Dashboard wireframe">
      <section class="block team-picker" aria-label="Team selector">Team = Sales</section>

      <section class="section" aria-label="Summary">
        <h2 class="section-title">Summary</h2>
        <div class="overview-grid">
          <article class="block metric-card">
            <span class="metric-number">10</span>
            <span class="metric-label">High performers</span>
          </article>
          <article class="block metric-card">
            <span class="metric-number">20</span>
            <span class="metric-label">Neutral members</span>
          </article>
          <article class="block metric-card">
            <span class="metric-number">5</span>
            <span class="metric-label">Low performers</span>
          </article>
        </div>
      </section>

      <section class="section" aria-label="AI Coach">
        <h2 class="section-title">AI Coach</h2>
        <div class="block coach-shell">
          <h3 class="group-title positive-title">Pattern of High performers</h3>
          <div class="pattern-grid">
            <article class="block pattern-card positive-card">
              <span class="pattern-icon" aria-hidden="true">▲</span>
              <span class="pattern-text">Meetings below <strong>12h/week</strong></span>
            </article>
            <article class="block pattern-card positive-card">
              <span class="pattern-icon" aria-hidden="true">▲</span>
              <span class="pattern-text">Focused work above <strong>4.5h/day</strong></span>
            </article>
            <article class="block pattern-card positive-card">
              <span class="pattern-icon" aria-hidden="true">▲</span>
              <span class="pattern-text">Follow-ups closed within <strong>24h</strong></span>
            </article>
          </div>

          <h3 class="group-title negative-title">Pattern of Low performers</h3>
          <div class="pattern-grid">
            <article class="block pattern-card negative-card">
              <span class="pattern-icon" aria-hidden="true">▼</span>
              <span class="pattern-text">Meetings above <strong>22h/week</strong></span>
            </article>
            <article class="block pattern-card negative-card">
              <span class="pattern-icon" aria-hidden="true">▼</span>
              <span class="pattern-text">More than <strong>18 app switches/day</strong></span>
            </article>
            <article class="block pattern-card negative-card">
              <span class="pattern-icon" aria-hidden="true">▼</span>
              <span class="pattern-text">Over <strong>30% tasks</strong> without owners</span>
            </article>
          </div>

          <h3 class="group-title suggestion-title">Theme suggestion</h3>
          <article class="block team-suggestion">
            <p class="suggestion-copy">
              Move low performers toward high-performance behavior by capping meetings at <strong>3h/day</strong>,
              enforcing a <strong>24h follow-up rule</strong>, and coaching the bottom <strong>5 members</strong>
              with weekly action plans focused on focus-time recovery.
            </p>
          </article>
        </div>
      </section>

      <section class="section" aria-label="Table raw data">
        <div class="section-header">
          <h2 class="section-title">Table (raw data)</h2>
          <button id="tier-toggle" class="tier-toggle" type="button" aria-pressed="false">Top performance first</button>
        </div>

        <div class="raw-shell">
          <div class="table-wrap">
            <table class="perf-table" aria-label="Performance table">
              <thead>
                <tr>
                  <th class="sortable" data-key="name" aria-sort="none">Name</th>
                  <th class="sortable" data-key="activity" aria-sort="none">Activity</th>
                  <th class="sortable" data-key="focus" aria-sort="none">Focus time</th>
                  <th class="sortable" data-key="meetings" aria-sort="none">Meetings time</th>
                  <th class="sortable" data-key="core" aria-sort="none">Core work</th>
                  <th class="sortable" data-key="output" aria-sort="none">Output</th>
                  <th class="sortable" data-key="health" aria-sort="none">Health</th>
                  <th>Suggestion</th>
                </tr>
              </thead>
              <tbody id="performance-table-body"></tbody>
            </table>
          </div>
        </div>
      </section>
    </main>

    <script>
      const topNames = [
        "Ava Chen",
        "Noah Patel",
        "Mia Johnson",
        "Liam Garcia",
        "Emma Walker",
        "Lucas Kim",
        "Olivia Brown",
        "Ethan Davis",
        "Sophia Miller",
        "James Wilson"
      ];

      const neutralNames = [
        "Charlotte Moore",
        "Benjamin Taylor",
        "Amelia Anderson",
        "Henry Thomas",
        "Isabella White",
        "Alexander Harris",
        "Harper Martin",
        "Daniel Thompson",
        "Evelyn Robinson",
        "Michael Clark",
        "Abigail Lewis",
        "Matthew Young",
        "Ella Hall",
        "David Allen",
        "Scarlett King",
        "Joseph Wright",
        "Grace Scott",
        "Samuel Green",
        "Nora Baker",
        "Andrew Adams"
      ];

      const lowNames = [
        "Lily Nelson",
        "Christopher Carter",
        "Chloe Mitchell",
        "Gabriel Perez",
        "Hannah Turner"
      ];

      function randInt(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      }

      function toTime(totalMinutes) {
        const hours = String(Math.floor(totalMinutes / 60)).padStart(2, "0");
        const minutes = String(totalMinutes % 60).padStart(2, "0");
        return hours + ":" + minutes;
      }

      function createMember(name, ranges, tier, tierOrder, role) {
        return {
          name,
          role,
          activity: Math.min(90, randInt(ranges.activity[0], ranges.activity[1])),
          focus: toTime(randInt(ranges.focus[0], ranges.focus[1])),
          meetings: toTime(randInt(ranges.meetings[0], ranges.meetings[1])),
          core: randInt(ranges.core[0], ranges.core[1]),
          output: randInt(ranges.output[0], ranges.output[1]),
          health: randInt(ranges.health[0], ranges.health[1]),
          tier,
          tierOrder
        };
      }

      const topRanges = {
        activity: [72, 88],
        focus: [180, 300],
        meetings: [30, 180],
        core: [75, 95],
        output: [78, 96],
        health: [70, 92]
      };

      const neutralRanges = {
        activity: [45, 78],
        focus: [80, 220],
        meetings: [90, 300],
        core: [48, 76],
        output: [45, 77],
        health: [48, 80]
      };

      const lowRanges = {
        activity: [20, 60],
        focus: [30, 105],
        meetings: [210, 420],
        core: [20, 49],
        output: [20, 49],
        health: [25, 55]
      };

      const tbody = document.getElementById("performance-table-body");
      const headers = document.querySelectorAll(".perf-table th.sortable");
      const tierToggle = document.getElementById("tier-toggle");
      const rolePool = [
        "Account Executive",
        "Sales Development Rep",
        "Customer Success Manager",
        "Sales Operations Analyst",
        "Partnership Manager"
      ];

      function roleFor(index, tier) {
        if (tier === "top") return rolePool[index % rolePool.length];
        if (tier === "neutral") return rolePool[(index + 2) % rolePool.length];
        return rolePool[(index + 3) % rolePool.length];
      }

      const topMembers = topNames.map((name, index) => createMember(name, topRanges, "top", 1, roleFor(index, "top")));
      const neutralMembers = neutralNames.map((name, index) =>
        createMember(name, neutralRanges, "neutral", 2, roleFor(index, "neutral"))
      );
      const lowMembers = lowNames.map((name, index) => createMember(name, lowRanges, "low", 3, roleFor(index, "low")));

      const anomalyOverrides = {
        "Lily Nelson": { activity: 88, focus: "03:40", meetings: "06:15", core: 42, output: 36, health: 41 },
        "Gabriel Perez": { activity: 85, focus: "02:55", meetings: "06:40", core: 39, output: 31, health: 38 },
        "Charlotte Moore": { activity: 84, focus: "01:20", meetings: "05:50", core: 52, output: 48, health: 46 },
        "Andrew Adams": { activity: 58, focus: "04:35", meetings: "01:10", core: 74, output: 76, health: 79 },
        "Sophia Miller": { activity: 61, focus: "04:45", meetings: "01:05", core: 90, output: 92, health: 87 }
      };

      function applyAnomalies(members) {
        members.forEach((member) => {
          if (anomalyOverrides[member.name]) {
            Object.assign(member, anomalyOverrides[member.name]);
            member.activity = Math.min(90, member.activity);
          }
        });
      }

      applyAnomalies(topMembers);
      applyAnomalies(neutralMembers);
      applyAnomalies(lowMembers);

      const allMembers = [...topMembers, ...neutralMembers, ...lowMembers];

      const sortState = {
        key: null,
        direction: "asc"
      };
      let expandedMemberName = null;
      let currentRows = [...allMembers];
      let performanceOrder = "top-first";

      function timeToMinutes(value) {
        const [hours, minutes] = value.split(":").map(Number);
        return hours * 60 + minutes;
      }

      function valueForSort(member, key) {
        if (key === "name") return member.name.toLowerCase();
        if (key === "focus" || key === "meetings") return timeToMinutes(member[key]);
        return member[key];
      }

      function labelForTier(tier) {
        if (tier === "top") return "High performer";
        if (tier === "low") return "Low performer";
        return "Neutral performer";
      }

      function buildInsights(member) {
        const focusMinutes = timeToMinutes(member.focus);
        const meetingMinutes = timeToMinutes(member.meetings);
        const questions = [];
        const behaviors = [];

        if (member.tier === "top") {
          questions.push("What routines help you protect focused work blocks each day?");
          questions.push("How do you decide which meetings to decline or shorten?");
          questions.push("What communication habits keep your output high without burning out?");
          if (meetingMinutes < 150) {
            behaviors.push("Document this person's meeting triage method and share it with low performers.");
          }
          if (focusMinutes > 240) {
            behaviors.push("Use this person's calendar-blocking strategy as the team default.");
          }
        } else if (member.tier === "low") {
          if (meetingMinutes > 240) {
            behaviors.push("Cut meeting load by 20% next week and convert updates to async Slack posts.");
          }
          if (focusMinutes < 120) {
            behaviors.push("Schedule two daily 60-minute focus blocks with notifications off.");
          }
          if (member.activity > 80 && member.output < 50) {
            behaviors.push("Reduce context switching by batching Slack and email checks to 3 windows per day.");
          }
          if (member.core < 50) {
            behaviors.push("Clarify top 3 owned tasks for the week and track completion by end of day Friday.");
          }
          if (member.health < 50) {
            behaviors.push("Add workload check-ins and remove one recurring low-value commitment.");
          }
        } else {
          if (meetingMinutes > 210) {
            behaviors.push("Pilot a no-meeting half day twice per week.");
          }
          if (focusMinutes >= 210 && member.output < 70) {
            behaviors.push("Pair focus time with clear daily output targets to improve conversion.");
          }
        }

        if (!behaviors.length) {
          behaviors.push("Maintain current cadence and review progress in the next weekly coaching check-in.");
        }

        return { questions, behaviors };
      }

      function tierRank(member) {
        return performanceOrder === "top-first" ? member.tierOrder : 4 - member.tierOrder;
      }

      function updateTierToggleLabel() {
        if (performanceOrder === "top-first") {
          tierToggle.textContent = "Top performance first";
          tierToggle.setAttribute("aria-pressed", "false");
        } else {
          tierToggle.textContent = "Bottom performance first";
          tierToggle.setAttribute("aria-pressed", "true");
        }
      }

      function getSortedRows() {
        const direction = sortState.direction === "asc" ? 1 : -1;
        return [...allMembers].sort((a, b) => {
          const tierDiff = tierRank(a) - tierRank(b);
          if (tierDiff !== 0) return tierDiff;

          if (sortState.key) {
            const aValue = valueForSort(a, sortState.key);
            const bValue = valueForSort(b, sortState.key);
            if (aValue < bValue) return -1 * direction;
            if (aValue > bValue) return 1 * direction;
          }

          return a.name.localeCompare(b.name);
        });
      }

      function renderRows(rows) {
        tbody.innerHTML = "";
        rows.forEach((member) => {
          const insights = buildInsights(member);
          const isExpanded = expandedMemberName === member.name;
          const row = document.createElement("tr");
          row.className = "tier-row tier-" + member.tier;
          row.innerHTML = `
            <td>${member.name}</td>
            <td>${member.activity}%</td>
            <td>${member.focus}</td>
            <td>${member.meetings}</td>
            <td>${member.core}</td>
            <td>${member.output}</td>
            <td>${member.health}%</td>
            <td>
              <button
                class="action-toggle"
                type="button"
                data-member="${member.name}"
                aria-expanded="${isExpanded ? "true" : "false"}"
              >
                <span>Suggestion</span>
                <span class="chevron" aria-hidden="true">▸</span>
              </button>
            </td>
          `;
          tbody.appendChild(row);

          if (isExpanded) {
            const detailRow = document.createElement("tr");
            detailRow.className = "detail-row";
            detailRow.innerHTML = `
              <td colspan="8">
                <div class="detail-card">
                  <div class="detail-header">
                    <strong>${member.name}</strong>
                    <span class="detail-chip">${labelForTier(member.tier)}</span>
                    <span class="detail-chip role-chip">${member.role}</span>
                  </div>
                  <div class="detail-content">
                    <div>
                      <h4>Suggestions</h4>
                      <ul>
                        ${insights.behaviors.map((behavior) => `<li>${behavior}</li>`).join("")}
                      </ul>
                    </div>
                    ${
                      member.tier === "top"
                        ? `<div>
                      <h4>Questions to ask</h4>
                      <ul>
                        ${insights.questions.map((question) => `<li>${question}</li>`).join("")}
                      </ul>
                    </div>`
                        : ""
                    }
                  </div>
                </div>
              </td>
            `;
            tbody.appendChild(detailRow);
          }
        });
      }

      function updateHeaderState() {
        headers.forEach((header) => {
          header.classList.remove("sorted-asc", "sorted-desc");
          header.setAttribute("aria-sort", "none");
          if (header.dataset.key === sortState.key) {
            const state = sortState.direction === "asc" ? "ascending" : "descending";
            header.classList.add(sortState.direction === "asc" ? "sorted-asc" : "sorted-desc");
            header.setAttribute("aria-sort", state);
          }
        });
      }

      function sortBy(key) {
        if (sortState.key === key) {
          sortState.direction = sortState.direction === "asc" ? "desc" : "asc";
        } else {
          sortState.key = key;
          sortState.direction = "asc";
        }

        currentRows = getSortedRows();
        renderRows(currentRows);
        updateHeaderState();
      }

      headers.forEach((header) => {
        header.addEventListener("click", () => sortBy(header.dataset.key));
      });

      tbody.addEventListener("click", (event) => {
        const button = event.target.closest(".action-toggle");
        if (!button) return;
        expandedMemberName = expandedMemberName === button.dataset.member ? null : button.dataset.member;
        renderRows(currentRows);
      });

      tierToggle.addEventListener("click", () => {
        performanceOrder = performanceOrder === "top-first" ? "bottom-first" : "top-first";
        currentRows = getSortedRows();
        renderRows(currentRows);
        updateTierToggleLabel();
      });

      renderRows(currentRows);
      updateHeaderState();
      updateTierToggleLabel();
    </script>
  </body>
</html>
